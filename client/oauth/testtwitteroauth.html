<html>

<body>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "http://connect.facebook.net/en_US/all.js#xfbml=1&appId=207120562693777";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>

<script type="text/javascript" src="https://www.google.com/jsapi?key=ABQIAAAAGbCP7xAnDeaBWr-NDrNqXBQmMOc3nLjHthTa4EGe0lmmw0PRdxREC4FbLwhuQ0MKiSEZhZaqWLSXNA"></script>
<script type="text/javascript">
  google.load("jquery", "1.6.2");
  google.load("jqueryui", "1.7.2");
</script>

<script type="text/javascript" src="http://crypto-js.googlecode.com/files/2.4.0-crypto-sha1-hmac-pbkdf2-blockmodes-aes.js"></script>

<div class="fb-like" data-href="www.sinqrtel.com" data-send="true" data-width="450" data-show-faces="true" data-action="recommend"></div>

<img src="http://www.google.com/images/srpr/logo3w.png" id="auth-google" alt="Google Login"/>

<script type="text/javascript">

/////////////////// Auth /////////////////////////////////////////////////////
function getOAuthTimeStamp() {
    var time = new Date();
    var gmtTime = new Date(time.getTime() + (time.getTimezoneOffset() * 60000));

    return gmtTime / 1000;
}

function ignoreCaseSort(a, b) {
  var ret = 0;
  a = a.toLowerCase();
  b = b.toLowerCase();
  if(a > b) ret = 1;
  if(a < b) ret = -1;
  return ret;
}

/////////////////// String To Sign /////////////////////////////////////////////////////
function getStringToSign( params ) {
  var stringToSign = "";

  var fields = params.split("&");
  fields.sort(ignoreCaseSort);
  for (var i = 0; i < fields.length; i++) {
    var param = fields[i].split("=");
    var name =  param[0];
    var value = param[1];
    //Parameters that should be skipped... but we should see none...
    if (name == 'oauth_signature' || undefined  == value) continue;
    stringToSign += name;
    stringToSign += decodeURIComponent(value);
  }

  alert( stringToSign );

  return stringToSign;
}
//
//var params = new Array();
//myArray['one'] = 1;
//myArray['two'] = 2;
//myArray['three'] = 3;
//
//// show the values stored
//for (var i in myArray) {
//	alert('key is: ' + i + ', value is: ' + myArray[i]);
//}

/////////////////// Signed URL /////////////////////////////////////////////////////
function generateSignedParams( oauth_callback, oauth_consumer_key, oauth_nonce, oauth_consumer_secret, oauth_token_secret ) {
  //signable parameters
  var params = "oauth_version=1.0&oauth_signature_method=HMAC-SHA1"
  params += "&oauth_consumer_key=" + encodeURIComponent( oauth_consumer_key );
  params += "&oauth_nonce=" + encodeURIComponent( oauth_nonce );
  params += "&oauth_timestamp=" + encodeURIComponent( get_OAuthTimeStamp() );

  //calculate V1 signature with signable parameters
  var stringToSign = getStringToSign( params );
  var signature = Crypto.util.bytesToBase64( Crypto.HMAC (Crypto.SHA1, Crypto.charenc.UTF8.stringToBytes( stringToSign ), Crypto.charenc.UTF8.stringToBytes( oauth_consumer_secret + "&" + oauth_token_secret ), {asBytes: true}));

  //parameters that should not be signed
  params += "&oauth_signature=" + encodeURIComponent( signature );
  return params;
}

function invokeRequest() {
    var postBody = generateSignedParams("http://www.sinqrtel.com/", messageBody.value, getPublicQueueURI(), getPublicId(), getPublicAccessKey(), "https://queue.amazonaws.com", "2009-02-01");
  //request creation
  var http = new XMLHttpRequest();
  http.open("POST", getPublicQueueURI(), true);
  http.setRequestHeader("Content-type", "application/x-www-form-urlencoded;"); //Send the proper header information along with the request
  http.setRequestHeader("Autorization", "application/x-www-form-urlencoded;"); //Send the header based oauth
  //request length can be skipped... so do it
  //http.setRequestHeader("Content-length", url.length);
  http.setRequestHeader("Connection", "close" );

  alert( postBody );
  http.send( postBody );

  http.onreadystatechange = function() {//Call a function when the state changes.
    if(http.readyState == 4 && http.status == 200) {
      alert("Sent, got 200" + http.responseText);
    }
  }
}

/*var oauth = OAuth({
    consumerKey: "Ey8qbJ1OJnqmOUUxSaoOw",
    consumerSecret: "KjtbULvvVg9iqjjvmZuDcUsvaxdO53xI0GKXaFW1XzA",
    //accessTokenKey: "[YOUR-PERSONAL-TWITTER-ACCESS-TOKEN-KEY]",
    //accessTokenSecret: "[YOUR-PERSONAL-TWITTER-ACCESS-TOKEN-SECRET]"
});

function success(data){
    var timeline = JSON.parse(data.text);
    timeline.forEach(function (element){
        alert(element.text);
    });
}

function failure(data) {
    alert("Throw rotten fruit, something failed");
}*/

//https://accounts.google.com/o/oauth2/auth?client_id=932822599581.apps.googleusercontent.com&redirect_uri=http%3A%2F%2Fwww.sinqrtel.com%2Fauth%2Fgoogle_callback.html&scope=https%3A%2F%2Fwww.googleapis.com%2Fauth%2Fuserinfo%23email&response_type=token&state=undefined
function get_google_authorization_uri( client_id, redirect_uri, scope, state ) {
  return "https://accounts.google.com/o/oauth2/auth?client_id=" + encodeURIComponent( client_id )
    + "&redirect_uri=" + encodeURIComponent( redirect_uri )
    + "&scope=" + encodeURIComponent( scope )
    + "&response_type=token" + "&state="
    + encodeURIComponent( state );
}

$(document).ready(function() {
  $("#auth-google").click(function(){
    //invokeRequest();
    var oauth_google_url = get_google_authorization_uri("932822599581.apps.googleusercontent.com","http://www.sinqrtel.com/auth/google_callback.html","https://www.googleapis.com/auth/userinfo#email");
    //can request, expires in not needed
    //https://www.googleapis.com/userinfo/email?alt=json&access_token=ya29.AHES6ZRGoXI6ozgKpYEqBlQtHraMfWW_UwleUlpHVpcJu9as8GuBhg&token_type=Bearer&expires_in=3600
    alert ( oauth_google_url );
    window.open( oauth_google_url, "Google oAuth", "top=40,left=60,width=500,height=350,menubar=no,toolbar=no,location=no,resizable=no,scrollbars=no,status=no");
  });
});

</script>

</body>
</html>
